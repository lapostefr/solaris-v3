import{d as ne,r as y,c,l as le,Y as se,o as l,e as r,f as H,B as d,t as _,b as x,E as re,C as z,y as m,F as C,x as B,A as E,H as S,v as T,z as ce}from"./vue.esm-bundler-BIhSTzsT.js";import{S as F}from"./Checkbox-CAW1jdel.js";import{S as ie}from"./Icon-DZ5u0r7n.js";import{S as ue}from"./Pagination-CExAv8sg.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"table__container"},ve={key:0,class:"table__top"},pe={class:"table__inner"},be={key:0,class:"visually-hidden"},fe={class:"table__head"},_e={class:"table__row"},he={class:"table__flex"},ke={class:"table__body"},ge=["data-before-content"],ye={key:1,class:"table__value"},we={key:1,class:"table__bottom"},W=ne({__name:"Table",props:{alternateBackground:{type:Boolean},content:{},description:{default:void 0},headers:{},mobileScroll:{type:Boolean,default:!0},id:{},rowsQty:{default:0},title:{default:void 0}},emits:["checkRow"],setup(j,{emit:A}){const i=j,M=A,I=y({}),p=y(0),w=y(0),k=y(1),b=y(2),P=y(!1),O=(t,a,e)=>{M("checkRow",{row:t,col:a,data:e})},u=c(()=>{const t=i.headers.map(a=>{const e={...a},o=(e.checkbox&&e.checkbox.length>0)??!1,n=e.checkbox&&e.checkbox==="checked",s=e.checkbox&&e.checkbox==="indeterminate",v="arrow-sort",V=e.align?`table__cell--${e.align}`:"table__cell--start";return delete e.checkbox,delete e.align,{...e,sortIcon:v,hasCheckbox:o,checked:n,indeterminate:s,alignClass:V}});return p.value>0&&(t[w.value].sortIcon=p.value%2===0?"arrow-large-down":"arrow-large-up"),t}),h=c(()=>i.content.map((a,e)=>Object.keys(a).map((n,s)=>{var Q,U,R;const v=a==null?void 0:a._options.filter(oe=>oe.col===s),V=n,ae={id:`${V}-${e}`,text:a[n],type:typeof((Q=v[0])==null?void 0:Q.checked)=="boolean"?"checkbox":"default",checked:(U=v[0])!=null&&U.checked?(R=v[0])==null?void 0:R.checked:!1};return{cellName:V,values:ae,options:v}}).filter(n=>n.cellName!=="_options"))),Y=c(()=>{let t="default";return p.value>0&&(t=p.value%2===0?"desc":"asc"),t}),G=c(()=>{let t,a,e;return i.description&&(a="aria-describedby",e=i.description.id,t={[a]:e}),t??{}}),$=()=>{var e,o;const t=(e=I[`tableWrapper-${i.id}`])==null?void 0:e.offsetWidth,a=(o=I[`tableItem-${i.id}`])==null?void 0:o.offsetWidth;P.value=t<a&&i.mobileScroll},L=c(()=>g.value*(k.value-1)),g=c(()=>i.rowsQty&&i.rowsQty>0?i.rowsQty:h.value.length),q=c(()=>{const t=g.value*(k.value-1)+g.value;return t>f.value?f.value:t}),f=c(()=>h.value.length),J=c(()=>g.value<f.value),D=c(()=>{const t=L.value,a=q.value;return[...h.value].sort(K.value).filter((e,o)=>o>=t&&o<a)}),K=c(()=>{const t=Y.value,a=w.value;return t!=="default"?function(e,o){const n=e[a].values.text.toString(),s=o[a].values.text.toString();return t==="desc"?s.localeCompare(n,void 0,{numeric:!0}):n.localeCompare(s,void 0,{numeric:!0})}:function(){return 0}}),X=c(()=>u.value.map((a,e)=>{let o,n="none",s;return p.value>0&&w.value===e&&(n=p.value%2===0?"descending":"ascending"),a.sortable&&(o="aria-sort",s={[o]:n}),s})??{}),Z=(t,a,e)=>{h.value[e][a].options[0].checked=!t,b.value=a,N(),O(e,a,h.value[e][a].values)},N=()=>{const t=h.value.filter(a=>a[b.value].options[0].checked).length;u.value[b.value].checked=t===f.value,u.value[b.value].indeterminate=t!==f.value&&t!==0},ee=(t,a)=>{u.value[a].checked=!t,u.value[a].indeterminate=!1,b.value=a,h.value.map(e=>(e[b.value].options[0].checked=u.value[a].checked,e))},te=t=>{p.value=w.value===t?p.value+1:1,w.value=t,k.value=1,N()};return le(()=>{$(),window.addEventListener("resize",$)}),u.value.map((t,a)=>(t.hasCheckbox&&(b.value=a,N()),t)),se(()=>{window.removeEventListener("resize",$)}),(t,a)=>(l(),r("div",me,[t.$slots.tableTop?(l(),r("div",ve,[H(t.$slots,"tableTop",{},void 0,!0)])):d("",!0),_("div",{ref:`tableWrapper-${t.id}`,class:T(["table__wrapper",{"table__wrapper--shadow":P.value&&t.mobileScroll}])},[_("div",pe,[t.description?(l(),x(re(t.description.tag?t.description.tag:"p"),{key:0,id:t.description.id,class:"visually-hidden",innerHTML:t.description.content},null,8,["id","innerHTML"])):d("",!0),_("table",z(G.value,{ref:`tableItem-${t.id}`,class:["table",{"table--no-scroll":!t.mobileScroll}]}),[t.title?(l(),r("caption",be,m(t.title),1)):d("",!0),_("thead",fe,[_("tr",_e,[(l(!0),r(C,null,B(u.value,(e,o)=>(l(),r("th",z({key:o,tabindex:"0",scope:"col",ref_for:!0},X.value[o],{class:["table__cell table__cell--th",[e.alignClass,{"table__cell--sortable":e.sortable}]]}),[_("div",he,[e.hasCheckbox?(l(),x(F,{key:0,id:`checkbox--${o}`,modelValue:e.checked,"onUpdate:modelValue":n=>e.checked=n,name:`checkbox--${o}`,indeterminate:e.indeterminate,onInput:n=>ee(e==null?void 0:e.checked,o)},{default:E(()=>[S(m(e.text)+" -- "+m(e.checked),1)]),_:2},1032,["id","modelValue","onUpdate:modelValue","name","indeterminate","onInput"])):d("",!0),e.hasCheckbox?d("",!0):(l(),r(C,{key:1},[S(m(e.text),1)],64)),e.sortable?(l(),x(ie,{key:2,class:"table__sort",name:e.sortIcon,type:"bold",onClick:n=>te(o)},null,8,["name","onClick"])):d("",!0)])],16))),128))])]),_("tbody",ke,[(l(!0),r(C,null,B(D.value,(e,o)=>(l(),r("tr",{key:o,class:T(["table__row table__row--body",{"table__row--alternate":t.alternateBackground,"table__row--selected":D.value[o][b.value].values.checked}])},[(l(!0),r(C,null,B(e,(n,s)=>(l(),r("td",{key:s,class:T(["table__cell",[u.value[s].alignClass]]),"data-before-content":u.value[s].text},[n.values.type==="checkbox"?(l(),x(F,{key:0,id:`checkbox--${o}--${s}`,modelValue:n.options[0].checked,"onUpdate:modelValue":v=>n.options[0].checked=v,class:"table__check-body",name:`checkbox--${o}--${s}`,onInput:v=>Z(n.options[0].checked,s,o+g.value*(k.value-1))},{default:E(()=>[S(m(n.values.text)+" -- "+m(n.options[0].checked),1)]),_:2},1032,["id","modelValue","onUpdate:modelValue","name","onInput"])):d("",!0),H(t.$slots,n.cellName,{content:n,index:o},void 0,!0),n.values.type==="default"?(l(),r("span",ye,m(n.values.text),1)):d("",!0)],10,ge))),128))],2))),128))])],16)])],2),J.value?(l(),r("div",we,[_("span",null,[S(m(L.value+1)+" - "+m(q.value)+" de "+m(f.value)+" élément",1),f.value>0?(l(),r(C,{key:0},[S("s")],64)):d("",!0)]),ce(ue,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value=e),class:"table__pagination","with-links":!1,"per-page":g.value,total:f.value},null,8,["modelValue","per-page","total"])])):d("",!0)]))}}),Ne=de(W,[["__scopeId","data-v-305daa0d"]]);W.__docgenInfo={exportName:"default",displayName:"Table",description:"",tags:{},props:[{name:"alternateBackground",required:!1,type:{name:"boolean"}},{name:"content",required:!0,type:{name:"Array",elements:[{name:"intersection",elements:[{name:"{ [key: string]: string | number }"},{name:"{ _options: Option[] }"}]}]}},{name:"description",required:!1,type:{name:"Description"},defaultValue:{func:!1,value:"undefined"}},{name:"headers",required:!0,type:{name:"Array",elements:[{name:"Thead"}]}},{name:"mobileScroll",required:!0,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"id",required:!0,type:{name:"string"}},{name:"rowsQty",required:!1,type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"title",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"undefined"}}],events:[{name:"checkRow"}],slots:[{name:"tableTop"},{name:"cell.cellName",scoped:!0,bindings:[{name:"name",title:"binding"},{name:"content",title:"binding"},{name:"index",title:"binding"}]}],sourceFiles:["/Users/jchourdeaux/workspace/projects/solaris/vue3/src/components/organisms/Table/Table.vue"]};export{Ne as S};
