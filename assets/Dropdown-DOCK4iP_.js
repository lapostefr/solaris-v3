import{d as Ge,m as ke,a as Re,r as w,M as xe,c as Ue,w as O,k as je,l as Je,e as n,t as k,u as a,v as S,y as q,B as u,J as c,I as _,z as N,A as Qe,T as We,o as r,G as Y,N as Xe,L as Se,b as B,n as $e,F as I,x as qe,P as Ye,K as Ze,C as ea,O as aa,q as la}from"./vue.esm-bundler-BHwbD8xO.js";import{S as Ve}from"./Icon-LmhyBlqB.js";import{_ as Fe}from"./Flag-BF-Ybv_M.js";import{S as oa}from"./Picture-CBfxdjno.js";import{A as sa,L as Z,b as M,T as C,S as ra,c as ta}from"./Input-CfpJPdR5.js";import{u as da,S as na}from"./useDropdown-B0lJwPIR.js";import{o as ia}from"./index-pMn-qRVg.js";import{_ as ua}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ca={class:"dropdown__wrapper"},pa=["aria-describedby","aria-invalid","aria-required"],ma=["for"],fa=["tabindex","aria-disabled","aria-readonly"],va={key:0,class:"dropdown__flag-container"},ya={class:"dropdown__value"},ba={key:1,class:"dropdown__container"},ga={key:0,class:"dropdown__placeholder"},ha={key:1,class:"dropdown__value"},wa={key:2,class:"dropdown__value"},_a=["id"],ka=["id","aria-selected","disabled","data-order","name","value","onKeydown","onChange"],Sa=["id","onUpdate:modelValue","aria-selected","disabled","data-order","name","value","onKeydown"],$a=["for"],qa={key:0,class:"dropdown__color"},Va={class:"dropdown__text"},Fa={key:1,class:"dropdown__no-result"},Me=Ge({__name:"Dropdown",props:ke({lazyload:{type:Boolean,default:!0},loadFlags:{type:Boolean},active:{default:sa.active},activeGroup:{type:Boolean},dataError:{},id:{},label:{},labelPosition:{default:Z.inside},listboxHeight:{default:0},mandatory:{type:Boolean},message:{},name:{},options:{},phoneCode:{},picto:{default:"arrow-bottom"},placeholder:{},selectionType:{},size:{default:M.default},type:{default:C.simple},searchField:{type:Boolean},searchFieldMode:{default:ra.contains}},{modelValue:{},modelModifiers:{}}),emits:ke(["simpleSelected","change","multiSelected"],["update:modelValue"]),setup(ee,{emit:Te}){var ge,he;const t=ee,ae=Re(ee,"modelValue"),K=Te,G=la(),p=w([]),le=w(null),v=w(),oe=w(),se=w(),R=w(!1),re=w({name:"",alt:""}),x=w(null),te=w(""),{id:y,options:de,active:Le,phoneCode:ne,searchField:ie,searchFieldMode:Ce,mandatory:ue}=xe(t),{clickTarget:D,toggleListBox:V,close:b,displayAllFlags:U,multiSelected:ce,focusItem:z,optionSelected:De,dynamicListboxHeight:ze,opened:T,dynamicHeight:pe,simpleValue:i,simpleLabel:L,searches:A,noSearchResult:Ae,multiValue:j,multiLabel:J,dynamicOptions:He,optionsList:H,dynamicOptionsList:Q,focusedIndex:$,firstIndexOpt:W,scrollSelectedValue:P,listForScroll:Pe,firstOptionChecked:me}=da(K,y,de,Le,ne,ie,Ce,p,oe,v,se);i.value=ae.value,ia(le,()=>b());const fe=Ue(()=>H.value.find(e=>e.flag&&e.checked));O(i,()=>{b(),i.value!==void 0&&(ae.value=i.value,K("simpleSelected",i.value))});const F=()=>t.selectionType?t.selectionType:t.type;O(de,()=>{X(fe.value)},{deep:!0});const ve=()=>{const e=H.value.find(l=>l.checked);if(e)return P.value=e.value,{label:e.label||e.value,value:e.value}},Ee=e=>{e.checked=!e.checked,H.value.forEach(l=>{l.id!==e.id&&(l.checked=!1)}),L.value=e.label||e.value,i.value=e.value,X(e),K("change",e)},X=e=>{e&&e.flag&&e.label?(R.value=!0,re.value={name:e.flag.name,alt:e.flag.alt}):R.value=!1},Oe=()=>{const l=v.value.sort((o,h)=>o.dataset.order-h.dataset.order),m=Q.value.findIndex(o=>o.checked&&!o.disabled),f=Q.value.every(o=>o.disabled);m>=0?$.value=m:W.value.disabled===0&&!f?$.value=W.value.enabled:$.value=0,Q.value.length>0&&l[$.value].focus()};O(A,async()=>{await ye()}),O(T,async()=>{await ye()});const ye=async()=>{var m,f;t.selectionType!=="simple"&&ze(),await aa();const e=p.value[t.id],l=p.value[`${t.id}-optionsList`];me.value=j.value?(m=H.value.find(o=>o.checked&&!o.disabled))==null?void 0:m.value:void 0,t.searchField&&((f=G==null?void 0:G.proxy)==null?void 0:f.$refs).search.$refs.inputRef.focus(),T.value?(P.value=F()==="multi"?me.value:i.value,l==null||l.scrollTo({top:Be(),left:0})):(P.value=void 0,e.focus())},Ne=e=>{var we,_e;const l=p.value[`${t.id}-optionsList`],m=p.value[`${e.id}-label`],f=e.position,o=e.groupNum+1,h=((we=p.value[`${t.id}-group-${o}`])==null?void 0:we.clientHeight)||0,s=(m==null?void 0:m.clientHeight)||0,d=(((l==null?void 0:l.clientHeight)||0)-s)/2;return t.searchField||((_e=v==null?void 0:v.value[f])==null||_e.focus(),$.value=f),o*h+f*s-d},Be=()=>{const e=De(Pe.value);if(P.value!==void 0&&e&&!e.disabled)return Ne(e);t.searchField||($.value=W.value.enabled,v==null||v.value[$.value].focus())},Ie=()=>{var e,l;return(e=t.dataError)!=null&&e.active&&((l=t.dataError)!=null&&l.message)?te.value:void 0},be=()=>{te.value=x.value.idMessage?x.value.idMessage:"error-message"},Ke=()=>{var e;return(e=t.dataError)!=null&&e.active?!0:null};F()==="simple"&&(i.value=(ge=ve())==null?void 0:ge.value,L.value=(he=ve())==null?void 0:he.label,X(fe.value));const g=()=>t.options.length&&!!t.options[0].optionsList&&t.options[0].optionsList.length?t.active:"disabled";return je(()=>{be()}),Je(()=>{be()}),(e,l)=>{var m,f;return r(),n("div",ca,[k("fieldset",{ref_key:"targetDropdown",ref:le,class:S(["dropdown",[`dropdown--${e.labelPosition}`,{"dropdown--small":e.size==a(M).small||e.size==a(M).compact,"dropdown--medium":e.size==a(M).medium||e.size==a(M).default||e.size==a(M).regular,"dropdown--filled":a(J)&&a(J).length>0||a(L)&&a(L).length>0,"dropdown--placeholder":!!e.placeholder,"dropdown--isOpen":a(T),"dropdown--disabled":g()==="disabled"}]]),"aria-describedby":Ie(),"aria-invalid":Ke(),"aria-required":a(ue)||null,onMouseover:l[13]||(l[13]=(...o)=>a(U)&&a(U)(...o))},[e.label?(r(),n("legend",{key:0,ref:o=>p.value[a(y)]=o,class:S(["dropdown__label",[`dropdown__label--${e.labelPosition}`,{"dropdown__label--mandatory":a(ue),"dropdown__label--disabled":g()==="disabled","dropdown__label--readonly":g()==="readonly"}]]),for:a(y)},q(e.label),11,ma)):u("",!0),k("div",{ref:o=>p.value[a(y)]=o,class:S(["dropdown__element",[`dropdown__element--${e.labelPosition}`,{"dropdown__element--inside-label":!!e.label&&e.labelPosition===a(Z).inside,"dropdown__element--inside-no-label":!e.label&&e.labelPosition===a(Z).inside,"dropdown__element--disabled":g()==="disabled","dropdown__element--readonly":g()==="readonly","dropdown__element--error":(m=e.dataError)==null?void 0:m.active}]]),tabindex:g()!=="disabled"?0:-1,"aria-disabled":g()==="disabled","aria-readonly":g()==="readonly",onClick:l[0]||(l[0]=(...o)=>a(V)&&a(V)(...o)),onKeydown:[l[1]||(l[1]=c(_((...o)=>a(V)&&a(V)(...o),["prevent"]),["space","enter"])),l[2]||(l[2]=c((...o)=>a(V)&&a(V)(...o),["down","up"])),l[3]||(l[3]=c(_((...o)=>a(b)&&a(b)(...o),["shift","exact"]),["tab"]))]},[R.value?(r(),n("span",va,[N(Fe,{class:"dropdown__flag-top",country:re.value},null,8,["country"]),k("span",ya,q(a(ne)),1)])):(r(),n("span",ba,[e.placeholder&&!a(j)&&!a(i)?(r(),n("span",ga,q(e.placeholder),1)):u("",!0),F()===a(C).multi&&a(j)?(r(),n("span",ha,q(a(J)),1)):u("",!0),F()===a(C).simple&&a(i)?(r(),n("span",wa,q(a(L)),1)):u("",!0)])),N(Ve,{name:e.picto,class:S(["dropdown__picto",{"dropdown__picto--isActive":e.picto==="arrow-bottom"&&a(T)}])},null,8,["name","class"])],42,fa),N(na,{ref_key:"childMessage",ref:x,message:e.message,error:(f=e.dataError)==null?void 0:f.message,"data-error":e.dataError},null,8,["message","error","data-error"]),N(We,{name:"lightbox"},{default:Qe(()=>[Y(k("div",{id:`${a(y)}-lightbox`,ref:o=>p.value[`${a(y)}-lightbox`]=o,class:"dropdown__lightbox",role:"listbox","aria-multiselectable":"true",style:Se([e.listboxHeight&&e.listboxHeight>16?{"max-height":e.listboxHeight+"px"}:"",a(pe)?{height:a(pe)+"px"}:""]),onKeydown:[l[10]||(l[10]=c((...o)=>a(D)&&a(D)(...o),["enter","space"])),l[11]||(l[11]=c((...o)=>a(b)&&a(b)(...o),["esc"])),l[12]||(l[12]=c(_((...o)=>a(b)&&a(b)(...o),["exact","prevent"]),["tab"]))]},[a(ie)?(r(),B(ta,{key:0,id:"idSearch",ref_key:"search",ref:oe,modelValue:a(A),"onUpdate:modelValue":l[4]||(l[4]=o=>$e(A)?A.value=o:null),class:"dropdown__search",name:"nameSearch",type:"text",label:"Rechercher",icon:"search-loupe","is-quiet":"",autocomplete:"off",onGoDown:Oe,onInput:a(U)},null,8,["modelValue","onInput"])):u("",!0),k("div",{ref:o=>p.value[`${a(y)}-optionsList`]=o,class:S(["dropdown__optionsList",{"dropdown__optionsList--readonly":g()==="readonly"}])},[(r(!0),n(I,null,qe(a(He),(o,h)=>(r(),n(I,{key:`dropdown-${a(y)}-group-${h}`},[e.activeGroup&&o.groupName?(r(),n("span",{key:0,ref_for:!0,ref:s=>p.value[`${a(y)}-group-${h}`]=s,class:"dropdown__group"},q(o.groupName),513)):u("",!0),(r(!0),n(I,null,qe(o.optionsList,(s,E)=>(r(),n(I,{key:`dropdown-${a(y)}-group-${h}-option-${E}-input`},[F()===a(C).simple?Y((r(),n("input",{key:0,id:s.id,ref_for:!0,ref_key:"optionRef",ref:v,"onUpdate:modelValue":l[5]||(l[5]=d=>$e(i)?i.value=d:null),type:"radio",role:"option","aria-selected":s.value===a(i),class:S(["dropdown__checker",[{"dropdown__checker--disabled":s.disabled}]]),disabled:s.disabled,"data-order":`${h}${E}`,name:s.radioName,value:s.value,onKeydown:[l[6]||(l[6]=c(_((...d)=>a(b)&&a(b)(...d),["prevent"]),["enter","space"])),c(_(d=>a(z)("previous",s.id),["prevent"]),["up"]),c(_(d=>a(z)("next",s.id),["prevent"]),["down"]),l[7]||(l[7]=c(_(()=>{},["prevent"]),["left","right"]))],onChange:d=>Ee(s)},null,42,ka)),[[Ye,a(i)]]):u("",!0),F()===a(C).multi?Y((r(),n("input",{key:1,id:s.id,ref_for:!0,ref_key:"optionRef",ref:v,"onUpdate:modelValue":d=>s.checked=d,type:"checkbox",role:"option","aria-selected":s.checked,class:S(["dropdown__checker",[{"dropdown__checker--disabled":s.disabled}]]),disabled:s.disabled,"data-order":`${h}${E}`,name:s.checkboxName,value:s.value,onKeydown:[l[8]||(l[8]=c((...d)=>a(D)&&a(D)(...d),["space"])),c(_(d=>a(z)("previous",s.id),["prevent"]),["up"]),c(_(d=>a(z)("next",s.id),["prevent"]),["down"])],onChange:l[9]||(l[9]=(...d)=>a(ce)&&a(ce)(...d))},null,42,Sa)),[[Ze,s.checked]]):u("",!0),k("label",{ref_for:!0,ref:d=>p.value[`${s.id}-label`]=d,for:s.id,class:S(["dropdown__item",[{"dropdown__item--disabled":s.disabled}]])},[s.color?(r(),n("i",qa,[k("span",{class:"dropdown__subcolor",style:Se({background:s.color})},null,4)])):u("",!0),s.icon?(r(),B(Ve,{key:1,name:s.icon,class:"dropdown__icon"},null,8,["name"])):u("",!0),e.loadFlags&&s.flag?(r(),B(Fe,{key:2,ref_for:!0,ref_key:"flag",ref:se,class:"dropdown__flag",country:{name:s.flag.name,alt:""},lazyload:""},null,8,["country"])):u("",!0),s.image?(r(),B(oa,ea({key:3,class:"dropdown__image",ref_for:!0},s.image),null,16)):u("",!0),k("span",Va,q(s.label||s.value),1)],10,$a)],64))),128))],64))),128))],2),a(Ae)?(r(),n("span",Fa,"Aucun résultat")):u("",!0)],44,_a),[[Xe,a(T)]])]),_:1})],42,pa)])}}}),Pa=ua(Me,[["__scopeId","data-v-46444ea8"]]);Me.__docgenInfo={exportName:"default",displayName:"Dropdown",description:"",tags:{},props:[{name:"lazyload",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"loadFlags",required:!1,type:{name:"boolean"}},{name:"active",required:!1,type:{name:"Active"},defaultValue:{func:!1,value:"Active.active"}},{name:"activeGroup",required:!1,type:{name:"boolean"}},{name:"dataError",required:!1,type:{name:"DataError"}},{name:"id",required:!0,type:{name:"string"}},{name:"label",required:!1,type:{name:"string"}},{name:"labelPosition",required:!1,type:{name:"LabelPosition"},defaultValue:{func:!1,value:"LabelPosition.inside"}},{name:"listboxHeight",required:!1,type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"mandatory",required:!1,type:{name:"boolean"}},{name:"message",required:!1,type:{name:"string"}},{name:"name",required:!0,type:{name:"string"}},{name:"options",required:!0,type:{name:"Array",elements:[{name:"Group"}]}},{name:"phoneCode",required:!1,type:{name:"string"}},{name:"picto",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'arrow-bottom'"}},{name:"placeholder",required:!1,type:{name:"string"}},{name:"selectionType",required:!1,type:{name:"SelectionType"}},{name:"size",required:!1,type:{name:"Size"},defaultValue:{func:!1,value:"Size.default"}},{name:"type",required:!1,type:{name:"Type"},defaultValue:{func:!1,value:"Type.simple"}},{name:"searchField",required:!1,type:{name:"boolean"}},{name:"searchFieldMode",required:!1,type:{name:"SearchFieldMode"},defaultValue:{func:!1,value:"SearchFieldMode.contains"}},{name:"value",defaultValue:{func:!1,value:"null"}}],events:[{name:"simpleSelected"},{name:"change"},{name:"multiSelected"}],sourceFiles:["/Users/jchourdeaux/workspace/projects/vue3-solaris/src/components/atoms/Dropdown/Default/Dropdown.vue"]};export{Pa as S};
