import{d as Ee,m as $e,r as g,b as Fe,c as _,o as Ve,g as v,y as z,v as T,A as M,C as y,D as te,I as k,H as E,e as P,G as ie,B as H,J as Ae,R as Ne,M as de,u as L,F as ue,z as pe,f as d,q as Pe}from"./vue.esm-bundler-CaiLyLZC.js";import{S as G}from"./Icon-CPWlc7Vn.js";import{_ as ce}from"./Flag-DcUWOxk_.js";import{S as qe}from"./Picture-NxZc57wS.js";import{S as Ce}from"./Message-BhgJ819g.js";import{c as De}from"./Input-RS4yhFRP.js";import{o as Ue}from"./index-CAhNJgAn.js";import{f as Oe}from"./generateId-CVaf2GGW.js";import{L as ve}from"./types-DKXD8uiR.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";var I=(u=>(u.DEFAULT="default",u.PREVIOUS="previous",u.NEXT="next",u))(I||{}),W=(u=>(u.MEDIUM="medium",u.SMALL="small",u))(W||{}),B=(u=>(u.CONTAINS="contains",u.STARTWITH="startswith",u))(B||{}),f=(u=>(u.SIMPLE="simple",u.MULTI="multi",u))(f||{});const Be=["id"],Re=["id"],Ke=["tabindex","aria-expanded","aria-controls","aria-labelledby","aria-describedby","aria-invalid","aria-required","aria-activedescendant","onKeydown"],je={key:1,class:"lp-dropdown__placeholder"},xe={key:2,class:"lp-dropdown__flag-wrapper"},He=["id","role","aria-multiselectable","aria-labelledby"],Ge={key:0,style:{padding:"8px"}},We={key:1,class:"lp-dropdown__overflow--empty"},Xe=["role","aria-multiselectable","aria-labelledby"],Je=["role","aria-labelledby"],Qe=["id"],Ye=["id","aria-selected","aria-disabled","onClick"],fe=Ee({__name:"Dropdown",props:$e({aria:{},dataError:{},disabled:{type:Boolean,default:!1},icon:{default:"arrow-bottom"},label:{},labelPosition:{default:ve.inside},lazyload:{type:Boolean,default:!0},listboxHeight:{default:300},loadFlags:{type:Boolean,default:!1},mandatory:{type:Boolean},message:{},name:{},options:{},placeholder:{default:"Sélectionnez une option"},readonly:{type:Boolean,default:!1},searchField:{type:Boolean,default:!1},searchFieldMode:{default:B.CONTAINS},selectionType:{default:f.SIMPLE},size:{default:W.MEDIUM}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const l=u,R=Pe(),q=g(!1),c=g(!1),me=g(!1),s=Fe(u,"modelValue"),b=g(""),X=g(null),n=g(0),i=g(""),C=g({}),J=g(null),$=g(!1);Ue(X,()=>w());const K=()=>{c.value=!c.value,n.value=-1,c.value&&setTimeout(()=>{var e,a,o;ee(),l.selectionType===f.MULTI&&s.value&&((e=s.value)==null?void 0:e.length)>0&&(n.value=(a=N(s.value[0]))==null?void 0:a.index),l.selectionType===f.SIMPLE&&s.value&&((o=s.value)==null?void 0:o.length)>0&&(n.value=N(s.value).index),F(I.DEFAULT)},200)},w=e=>{var a;c.value=!1,$.value=!1,e&&((a=J.value)==null||a.focus())},ye=()=>{var e,a;b.value&&(n.value=-1),b.value||(n.value=-1),l.selectionType===f.MULTI&&s.value&&b.value.length===0&&((e=s.value)==null?void 0:e.length)>0&&(n.value=N(s.value[0]).index),l.selectionType===f.SIMPLE&&s.value&&b.value.length===0&&((a=s.value)==null?void 0:a.length)>0&&(n.value=N(s.value).index),F(I.DEFAULT)},Q=()=>{b.value?b.value="":w(!0)},be=()=>{if(he(h.value)){if(n.value<0){w(!0);return}const a=j(h.value,n.value).value;b.value="",x(N(a))}else w(!0),b.value=""},he=e=>e.some(a=>a.optionsList.some(o=>!o.disabled)),j=(e,a)=>e.flatMap(o=>o.optionsList).find(o=>o.index===a),we=e=>{if(!c.value){K();return}F(e)},F=e=>{const o=ke(h.value),m=e===I.NEXT,S=e===I.PREVIOUS;if(c.value){if(l.readonly)return;$.value=!0,m&&n.value<o&&(n.value+=1),S&&n.value>-1&&(n.value-=1),m&&n.value===o&&(n.value=0),S&&n.value===-1&&(n.value=o-1),setTimeout(()=>{$.value&&ge()},200)}else w()},ge=()=>{if(ae.value||le.value){const e=C.value[i.value],a=C.value[`${i.value}-option-${n.value}`];e.scrollTo({top:(a==null?void 0:a.offsetTop)-80,left:0,behavior:"smooth"})}},V=e=>{var a;if(l.selectionType===f.MULTI&&Array.isArray(D.value))return!!((a=s.value)!=null&&a.includes(e));if(l.selectionType===f.SIMPLE)return s.value===e},D=_(()=>{var e;return l.selectionType===f.SIMPLE&&s.value?(e=U(s.value))==null?void 0:e.label:l.selectionType===f.MULTI&&Array.isArray(s.value)?s.value.map(a=>{var o;return(o=U(a))==null?void 0:o.label}):l.selectionType===f.SIMPLE&&!s.value?"":[]}),A=_(()=>{var e;return l.selectionType===f.MULTI&&Array.isArray(D.value)?(e=D.value)==null?void 0:e.join(", "):D.value}),_e=_(()=>{const e={},a=l.aria??{};return Object.keys(a).forEach(o=>e[`aria-${o}`]=a[o]),e}),Te=_(()=>{var a,o,m;const e=[];return(a=l.aria)!=null&&a.describedby&&e.push(l.aria.describedby),(o=l.dataError)!=null&&o.active&&((m=l.dataError)!=null&&m.message)?e.push(`error-message--${i.value}`):l.message&&e.push(`message--${i.value}`),e.length>0?e.join(" "):void 0}),Y=()=>{var e;return(e=l.dataError)!=null&&e.active?l.dataError.active:void 0},Se=()=>l.mandatory?l.mandatory:void 0,Z=e=>{c.value||K(),n.value>=0&&x(e)},x=e=>{let a=null;if(!(c.value&&!e)&&c.value){ee();const o=e.value;if(l.readonly)return;Le.value==="multi"?(s.value===null&&(a=[o]),V(o)&&Array.isArray(s.value)&&(a=s.value.filter(m=>m!==o)),!V(o)&&Array.isArray(s.value)&&(a=[...s.value,o])):a=o,s.value=a,n.value=e.index,l.selectionType==="simple"&&w()}},ee=()=>{var e;l.searchField&&c.value&&(me.value=!0,((e=R==null?void 0:R.proxy)==null?void 0:e.$refs).search.$refs.inputRef.focus())},Ie=e=>n.value===e&&c.value&&$.value,ke=e=>e.reduce((a,o)=>{const m=o.optionsList.filter(S=>!S.disabled).length;return a+m},0),Le=_(()=>l.loadFlags===!0?"simple":l.selectionType),h=_(()=>{let e=0,a=0;const o=l.searchFieldMode===B.CONTAINS?b.value:"",m=l.searchFieldMode===B.STARTWITH?b.value:"",S=l.options.filter(t=>t.label.toLowerCase().includes(String(o).toLowerCase())).filter(t=>t.label.toLowerCase().startsWith(m.toLowerCase())).reduce((t,p)=>{const r=p.groupName||"Sans groupe",O=p.disabled?null:e++;return t[r]?a++:(t[r]=[],a=0),t[r].push({index:O,subIndex:a,label:p.label,value:p.value,color:p.color,disabled:p.disabled,flag:p.flag,icon:p.icon,image:p.image,checkbox:p.checkbox}),t},{});return Object.entries(S).map(([t,p])=>({groupName:t,optionsList:p}))}),U=e=>l.options.find(a=>a.value===e),N=e=>h.value.flatMap(a=>a.optionsList).find(a=>a.value===e),ae=_(()=>{if($.value&&l.searchField&&c.value&&h.value.length>0&&n.value>=0)return`${i.value}-option-${n.value}`}),le=_(()=>{if($.value&&!l.searchField&&c.value&&h.value.length>0&&n.value>=0)return`${i.value}-option-${n.value}`}),Me=e=>{const a=e.match(/\(([^)]+)\)/);return a?a[1]:void 0},oe=_(()=>{if(!l.loadFlags)return;const e=U(s.value);return e?Me(e.label):null}),se=_(()=>{const e=U(s.value);return e!=null&&e.flag?{name:e.flag.name,alt:e.flag.alt}:null});return Ve(()=>{const e=l.selectionType===f.MULTI;q.value=l.options.some(a=>"groupName"in a),i.value=Oe("lp-dropdown--"),e&&(s.value=[])}),(e,a)=>{var o,m,S;return d(),v("div",{ref_key:"targetDropdown",ref:X},[z("div",{class:T(["lp-dropdown__wrapper",`lp-dropdown__wrapper--${e.size===L(W).SMALL?"small":"medium"}`])},[e.labelPosition==="outside"?(d(),v("div",{key:0,id:`${i.value}-label`,class:T([{"lp-dropdown__label--mandatory":e.mandatory},"lp-dropdown__label lp-dropdown__label--outside"])},M(e.label),11,Be)):y("",!0),z("div",{class:T(["lp-dropdown",[{"lp-dropdown--readonly":e.readonly},{"lp-dropdown--disabled":e.disabled},{"lp-dropdown--is-open":c.value},{"lp-dropdown--error":(o=e.dataError)==null?void 0:o.active},{"lp-dropdown--label-is-inside":e.labelPosition==="inside"&&(!!e.placeholder||!!A.value)},{"lp-dropdown--label-alone":!e.placeholder&&!A.value&&e.labelPosition==="inside"}]])},[e.labelPosition==="inside"?(d(),v("div",{key:0,id:`${i.value}-label`,class:T([{"lp-dropdown__label--mandatory":e.mandatory},"lp-dropdown__label lp-dropdown__label--inside"])},M(e.label),11,Re)):y("",!0),z("div",te({ref_key:"dropdownRef",ref:J,class:"lp-dropdown__combobox",role:"combobox","aria-haspopup":"listbox",tabindex:e.disabled?void 0:0},_e.value,{"aria-expanded":`${c.value&&h.value.length>0}`,"aria-controls":i.value,"aria-labelledby":`${i.value}-label`,"aria-describedby":Te.value,"aria-invalid":Y()?Y():void 0,"aria-required":Se(),"aria-activedescendant":le.value,onKeydown:[k(Q,["esc"]),k(w,["tab"]),k(E(w,["shift","exact"]),["tab"]),a[0]||(a[0]=k(E(t=>Z(j(h.value,n.value)),["prevent"]),["enter"])),a[1]||(a[1]=k(E(t=>we(L(I).NEXT),["prevent"]),["down"])),a[2]||(a[2]=k(E(t=>F(L(I).PREVIOUS),["prevent"]),["up"])),a[3]||(a[3]=k(E(t=>Z(j(h.value,n.value)),["prevent"]),["space"]))],onClick:E(K,["prevent"])}),[A.value&&!e.loadFlags?(d(),v("span",{key:0,class:T(["lp-dropdown__value",{"lp-dropdown__value--error":(m=e.dataError)==null?void 0:m.active}])},M(A.value),3)):y("",!0),e.placeholder&&!A.value?(d(),v("span",je,M(e.placeholder),1)):y("",!0),e.loadFlags&&oe.value?(d(),v("span",xe,[se.value?(d(),P(ce,{key:0,class:"lp-dropdown__flag",country:se.value},null,8,["country"])):y("",!0),ie(" "+M(oe.value),1)])):y("",!0)],16,Ke),H(G,{class:T(["lp-dropdown__arrow",{"lp-dropdown__arrow--error":(S=e.dataError)==null?void 0:S.active}]),name:e.icon},null,8,["class","name"])],2),Ae(z("div",{id:i.value,class:"lp-dropdown__listbox",style:de([{"max-height":e.listboxHeight+"px"}]),role:e.searchField?void 0:"listbox","aria-multiselectable":!e.searchField&&e.selectionType===L(f).MULTI||void 0,"aria-labelledby":e.searchField?void 0:`${i.value}-label`},[e.searchField?(d(),v("div",Ge,[H(De,{id:`${i.value}-search`,ref:"search",modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=t=>b.value=t),class:"dropdown__search",name:"nameSearch",type:"text",label:"Rechercher","label-position":L(ve).inside,icon:"search-loupe","is-quiet":"",autocomplete:"off",autofocus:!0,size:e.size||void 0,aria:{activedescendant:ae.value||"",autocomplete:"list"},onInput:ye,onKeydown:k(E(w,["shift"]),["tab"]),onEscKeydown:Q,onTabKeydown:w,onEnterPressed:be,onGoUp:a[5]||(a[5]=t=>F(L(I).PREVIOUS)),onGoDown:a[6]||(a[6]=t=>F(L(I).NEXT))},null,8,["id","modelValue","label-position","size","aria","onKeydown"])])):y("",!0),h.value.length===0?(d(),v("div",We," Aucun Résultat ")):(d(),v("div",{key:2,ref:t=>C.value[`${i.value}`]=t,class:T(["lp-dropdown__overflow",{"lp-dropdown__overflow--readonly":e.readonly}]),role:e.searchField?"listbox":void 0,"aria-multiselectable":!!(e.searchField&&e.selectionType===L(f).MULTI)||void 0,"aria-labelledby":e.searchField?`${i.value}-label ${i.value}-search-label`:void 0},[(d(!0),v(ue,null,pe(h.value,(t,p)=>(d(),v("ul",{key:p,class:"lp-dropdown__group",role:q.value?"group":void 0,"aria-labelledby":q.value?`${i.value}-group-${p}`:void 0},[q.value?(d(),v("li",{key:0,id:`${i.value}-group-${p}`,class:T(["lp-dropdown__group-name",{"lp-dropdown__group-name--border":p!==0}]),role:"presentation"},M(t.groupName),11,Qe)):y("",!0),(d(!0),v(ue,null,pe(t.optionsList,(r,O)=>{var re;return d(),v("li",{key:`${p}-${O}`,id:`${i.value}-option-${r.disabled?p+"-"+O:r.index}`,ref_for:!0,ref:ne=>C.value[`${i.value}-option-${r.index}`]=ne,class:T(["lp-dropdown__option",[{"lp-dropdown__option--selected":V(r.value)},{"lp-dropdown__option--disabled":r.disabled},{"lp-dropdown__option--focused":Ie(r.index)}]]),role:"option","aria-selected":V(r.value),"aria-disabled":r.disabled?r.disabled:void 0,onClick:ne=>x(r)},[r.color?(d(),v("span",{key:0,class:"lp-dropdown__color",style:de({background:r.color})},null,4)):y("",!0),r.icon?(d(),P(G,{key:1,name:r.icon,class:"lp-dropdown__icon"},null,8,["name"])):y("",!0),typeof r.image=="object"&&r.image!==null?(d(),P(qe,te({key:2,class:"lp-dropdown__image",ref_for:!0},r.image),null,16)):y("",!0),e.loadFlags&&r.flag?(d(),P(ce,{key:3,class:"lp-dropdown__flag",country:{name:(re=r.flag)==null?void 0:re.name,alt:r.flag.alt},lazyload:""},null,8,["country"])):y("",!0),r.checkbox?(d(),v("span",{key:4,class:T([{checked:V(r.value)},"lp-dropdown__checkbox lp-dropdown__checkbox--default checkbox__custom"])},null,2)):y("",!0),ie(" "+M(r.label)+" ",1),V(r.value)?(d(),P(G,{key:5,name:"action-check-switch",class:"lp-dropdown__option--checked",title:"option sélectionnée"})):y("",!0)],10,Ye)}),128))],8,Je))),128))],10,Xe))],12,He),[[Ne,c.value]])],2),H(Ce,{id:i.value,message:e.message,"data-error":e.dataError},null,8,["id","message","data-error"])],512)}}}),da=ze(fe,[["__scopeId","data-v-a1e5793d"]]);fe.__docgenInfo={exportName:"default",displayName:"Dropdown",description:"",tags:{},props:[{name:"aria",required:!1,type:{name:`{
  [key: string]: string
}`}},{name:"dataError",required:!0,type:{name:"ErrorMessage"}},{name:"disabled",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"icon",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'arrow-bottom'"}},{name:"label",required:!1,type:{name:"string"}},{name:"labelPosition",required:!1,type:{name:"LabelPosition"},defaultValue:{func:!1,value:"LabelPosition.inside"}},{name:"lazyload",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"listboxHeight",required:!1,type:{name:"number"},defaultValue:{func:!1,value:"300"}},{name:"loadFlags",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"mandatory",required:!1,type:{name:"boolean"}},{name:"message",required:!1,type:{name:"string"}},{name:"name",required:!0,type:{name:"string"}},{name:"options",required:!0,type:{name:"Options"}},{name:"placeholder",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'Sélectionnez une option'"}},{name:"readonly",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"searchField",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"searchFieldMode",required:!1,type:{name:"DropdownSearchMode"},defaultValue:{func:!1,value:"DropdownSearchMode.CONTAINS"}},{name:"selectionType",required:!1,type:{name:"DropdownSelectionType"},defaultValue:{func:!1,value:"DropdownSelectionType.SIMPLE"}},{name:"size",required:!1,type:{name:"union",elements:[{name:"DropdownSizes"},{name:"undefined"}]},defaultValue:{func:!1,value:"DropdownSizes.MEDIUM"}},{name:"madatory",defaultValue:{func:!1,value:"false"}}],sourceFiles:["/Users/jchourdeaux/workspace/projects/solaris/vue3/src/components/atoms/Dropdown/New/Dropdown.vue"]};export{B as D,da as S,f as a,W as b};
