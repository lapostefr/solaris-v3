import{d as Me,m as Ee,r as w,b as Ie,c as M,o as $e,g as v,y as R,v as T,A as E,C as y,e as P,H as te,F as X,J as k,I,B as J,G as Fe,Q as Ve,L as ie,u as $,z as de,f as u,D as Ae,q as Ce}from"./vue.esm-bundler-BiAlgFmf.js";import{S as Q}from"./Icon-C-Sturzh.js";import{_ as ue}from"./Flag-BadvXT23.js";import{S as Ne}from"./Picture-BXByxoYg.js";import{S as Pe}from"./Message-MlHtBEps.js";import{c as De}from"./Input-BClLXKNP.js";import{o as qe}from"./index-a4aneQim.js";import{f as Ue}from"./generateId-CVaf2GGW.js";import{L as pe}from"./types-DKXD8uiR.js";import{_ as Oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";var S=(p=>(p.DEFAULT="default",p.PREVIOUS="previous",p.NEXT="next",p))(S||{}),ve=(p=>(p.MEDIUM="medium",p.SMALL="small",p))(ve||{}),x=(p=>(p.CONTAINS="contains",p.STARTWITH="startswith",p))(x||{}),f=(p=>(p.SIMPLE="simple",p.MULTI="multi",p))(f||{});const ze=["id"],Be={key:0,class:"lp-dropdown__flag-wrapper"},Re=["id"],xe=["tabindex","aria-expanded","aria-controls","aria-labelledby","aria-describedby","aria-invalid","aria-activedescendant","onKeydown"],Ke={key:1,class:"lp-dropdown__placeholder"},He=["id","role","aria-multiselectable","aria-labelledby"],je={key:0,style:{padding:"8px"}},Ge={key:1,class:"lp-dropdown__overflow--empty"},We=["role","aria-multiselectable","aria-labelledby"],Xe=["role","aria-labelledby"],Je=["id"],Qe=["id","aria-selected","aria-disabled","onClick"],ce=Me({__name:"Dropdown",props:Ee({dataError:{},disabled:{type:Boolean,default:!1},icon:{default:"arrow-bottom"},label:{},labelPosition:{default:pe.inside},lazyload:{type:Boolean,default:!0},listboxHeight:{default:300},loadFlags:{type:Boolean,default:!1},mandatory:{type:Boolean},message:{},name:{},options:{},placeholder:{default:"Sélectionnez une option"},readonly:{type:Boolean,default:!1},searchField:{type:Boolean,default:!1},searchFieldMode:{default:x.CONTAINS},selectionType:{default:f.SIMPLE},size:{default:ve.MEDIUM}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(p){const o=p,K=Ce(),D=w(!1),c=w(!1),fe=w(!1),r=Ie(p,"modelValue"),b=w(""),Y=w(null),q=w(null),U=w(null),n=w(0),d=w(""),O=w({}),Z=w(null),F=w(!1);qe(Y,()=>_());const H=()=>{c.value=!c.value,n.value=-1,c.value&&setTimeout(()=>{var e,a,l;oe(),o.selectionType===f.MULTI&&r.value&&((e=r.value)==null?void 0:e.length)>0&&(n.value=(a=L(r.value[0]))==null?void 0:a.index),o.selectionType===f.SIMPLE&&r.value&&((l=r.value)==null?void 0:l.length)>0&&(n.value=L(r.value).index),V(S.DEFAULT)},200)},_=e=>{var a;c.value=!1,F.value=!1,e&&((a=Z.value)==null||a.focus())},me=()=>{var e,a;b.value&&(n.value=-1),b.value||(n.value=-1),o.selectionType===f.MULTI&&r.value&&b.value.length===0&&((e=r.value)==null?void 0:e.length)>0&&(n.value=L(r.value[0]).index),o.selectionType===f.SIMPLE&&r.value&&b.value.length===0&&((a=r.value)==null?void 0:a.length)>0&&(n.value=L(r.value).index),V(S.DEFAULT)},ee=()=>{b.value?b.value="":_(!0)},ye=()=>{if(be(h.value)){if(n.value<0){_(!0);return}const a=j(h.value,n.value).value;b.value="",W(L(a))}else _(!0),b.value=""},be=e=>e.some(a=>a.optionsList.some(l=>!l.disabled)),j=(e,a)=>e.flatMap(l=>l.optionsList).find(l=>l.index===a),he=e=>{if(!c.value){H();return}V(e)},V=e=>{const l=ke(h.value),m=e===S.NEXT,g=e===S.PREVIOUS;if(c.value){if(o.readonly)return;F.value=!0,m&&n.value<l&&(n.value+=1),g&&n.value>-1&&(n.value-=1),m&&n.value===l&&(n.value=0),g&&n.value===-1&&(n.value=l-1),setTimeout(()=>{F.value&&we()},200)}else _()},we=()=>{if(se.value||ne.value){const e=O.value[d.value],a=O.value[`${d.value}-option-${n.value}`];e.scrollTo({top:(a==null?void 0:a.offsetTop)-80,left:0,behavior:"smooth"})}},A=e=>{var a;if(o.selectionType===f.MULTI&&Array.isArray(z.value))return!!((a=r.value)!=null&&a.includes(e));if(o.selectionType===f.SIMPLE)return r.value===e},z=M(()=>{var e;return o.selectionType===f.SIMPLE&&r.value?(e=L(r.value))==null?void 0:e.label:o.selectionType===f.MULTI&&Array.isArray(r.value)?r.value.map(a=>{var l;return(l=L(a))==null?void 0:l.label}):o.selectionType===f.SIMPLE&&!r.value?"":[]}),C=M(()=>{var e;return o.selectionType===f.MULTI&&Array.isArray(z.value)?(e=z.value)==null?void 0:e.join(", "):z.value}),ge=M(()=>{var e,a;if((e=o.dataError)!=null&&e.active&&((a=o.dataError)!=null&&a.message))return`error-message--${d.value}`;if(o.message)return`message--${d.value}`}),ae=()=>{var e;return(e=o.dataError)!=null&&e.active?o.dataError.active:void 0},_e=()=>o.mandatory?o.mandatory:void 0,G=e=>{const a=e.match(/\(([^)]+)\)/);return a?a[1]:void 0},le=e=>{c.value||H(),n.value>=0&&W(e)},W=e=>{let a=null;if(!(c.value&&!e)&&c.value){oe();const l=e.value;if(o.readonly)return;o.loadFlags&&(q.value=e.flag,U.value=U.value===G(l)?null:G(l)),Le.value==="multi"?(r.value===null&&(a=[l]),A(l)&&Array.isArray(r.value)&&(a=r.value.filter(m=>m!==l)),!A(l)&&Array.isArray(r.value)&&(a=[...r.value,l])):a=l,r.value=a,n.value=e.index,o.selectionType==="simple"&&_()}},oe=()=>{var e;o.searchField&&c.value&&(fe.value=!0,((e=K==null?void 0:K.proxy)==null?void 0:e.$refs).search.$refs.inputRef.focus())},Te=e=>n.value===e&&c.value&&F.value,Se=(e,a)=>{const l=e.flatMap(({optionsList:i})=>i).find(({label:i})=>i===a);if(!l)return null;const{flag:{name:m,alt:g}={},phoneCode:t}=l;return{name:m,alt:g,phoneCode:t}},ke=e=>e.reduce((a,l)=>{const m=l.optionsList.filter(g=>!g.disabled).length;return a+m},0),Le=M(()=>o.loadFlags===!0?"simple":o.selectionType),h=M(()=>{let e=0,a=0;const l=o.searchFieldMode===x.CONTAINS?b.value:"",m=o.searchFieldMode===x.STARTWITH?b.value:"",g=o.options.filter(t=>t.label.toLowerCase().includes(String(l).toLowerCase())).filter(t=>t.label.toLowerCase().startsWith(m.toLowerCase())).reduce((t,i)=>{const s=i.groupName||"Sans groupe",B=i.disabled?null:e++;t[s]?a++:(t[s]=[],a=0);let N="";return o.loadFlags&&(N=G(i.value)),t[s].push({index:B,subIndex:a,label:i.label,value:i.value,color:i.color,disabled:i.disabled,flag:i.flag,icon:i.icon,image:i.image,checkbox:i.checkbox,phoneCode:N}),t},{});return Object.entries(g).map(([t,i])=>({groupName:t,optionsList:i}))}),L=e=>h.value.flatMap(a=>a.optionsList).find(a=>a.value===e),se=M(()=>{if(F.value&&o.searchField&&c.value&&h.value.length>0&&n.value>=0)return`${d.value}-option-${n.value}`}),ne=M(()=>{if(F.value&&!o.searchField&&c.value&&h.value.length>0&&n.value>=0)return`${d.value}-option-${n.value}`});return $e(()=>{const e=o.selectionType===f.MULTI;D.value=o.options.some(l=>"groupName"in l);const a=Se(h.value,"France (+33)");q.value={name:a==null?void 0:a.name,alt:a==null?void 0:a.alt},U.value=a==null?void 0:a.phoneCode,d.value=Ue("lp-dropdown--"),e&&(r.value=[])}),(e,a)=>{var l,m,g;return u(),v("div",{ref_key:"targetDropdown",ref:Y},[R("div",{class:T([`lp-dropdown__wrapper--${e.size}`,"lp-dropdown__wrapper"])},[e.labelPosition==="outside"?(u(),v("div",{key:0,id:`${d.value}-label`,class:T([{"lp-dropdown__label--mandatory":e.mandatory},"lp-dropdown__label lp-dropdown__label--outside"])},E(e.label),11,ze)):y("",!0),R("div",{class:T(["lp-dropdown",[{"lp-dropdown--readonly":e.readonly},{"lp-dropdown--disabled":e.disabled},{"lp-dropdown--is-open":c.value},{"lp-dropdown--error":(l=e.dataError)==null?void 0:l.active},{"lp-dropdown--label-is-inside":e.labelPosition==="inside"&&(!!e.placeholder||!!C.value)},{"lp-dropdown--label-alone":!e.placeholder&&!C.value&&e.labelPosition==="inside"}]])},[e.loadFlags?(u(),v("div",Be,[q.value?(u(),P(ue,{key:0,class:"lp-dropdown__flag",country:q.value},null,8,["country"])):y("",!0),te(" "+E(U.value),1)])):(u(),v(X,{key:1},[e.labelPosition==="inside"?(u(),v("div",{key:0,id:`${d.value}-label`,class:T([{"lp-dropdown__label--mandatory":e.mandatory},"lp-dropdown__label lp-dropdown__label--inside"])},E(e.label),11,Re)):y("",!0),R("div",{ref_key:"dropdownRef",ref:Z,class:"lp-dropdown__combobox",role:"combobox","aria-haspopup":"listbox",tabindex:e.disabled?void 0:0,"aria-expanded":`${c.value&&h.value.length>0}`,"aria-controls":d.value,"aria-labelledby":`${d.value}-label`,"aria-describedby":ge.value,"aria-invalid":ae()?ae():void 0,"aria-required":_e,"aria-activedescendant":ne.value,onKeydown:[k(ee,["esc"]),k(_,["tab"]),k(I(_,["shift","exact"]),["tab"]),a[0]||(a[0]=k(I(t=>le(j(h.value,n.value)),["prevent"]),["enter"])),a[1]||(a[1]=k(I(t=>he($(S).NEXT),["prevent"]),["down"])),a[2]||(a[2]=k(I(t=>V($(S).PREVIOUS),["prevent"]),["up"])),a[3]||(a[3]=k(I(t=>le(j(h.value,n.value)),["prevent"]),["space"]))],onClick:I(H,["prevent"])},[C.value?(u(),v("span",{key:0,class:T(["lp-dropdown__value",{"lp-dropdown__value--error":(m=e.dataError)==null?void 0:m.active}])},E(C.value),3)):y("",!0),e.placeholder&&!C.value?(u(),v("span",Ke,E(e.placeholder),1)):y("",!0)],40,xe)],64)),J(Q,{class:T(["lp-dropdown__arrow",{"lp-dropdown__arrow--error":(g=e.dataError)==null?void 0:g.active}]),name:e.icon},null,8,["class","name"])],2),Fe(R("div",{id:d.value,class:"lp-dropdown__listbox",style:ie([{"max-height":e.listboxHeight+"px"}]),role:e.searchField?void 0:"listbox","aria-multiselectable":!e.searchField&&e.selectionType===$(f).MULTI||void 0,"aria-labelledby":e.searchField?void 0:`${d.value}-label`},[e.searchField?(u(),v("div",je,[J(De,{id:`${d.value}-search`,ref:"search",modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=t=>b.value=t),class:"dropdown__search",name:"nameSearch",type:"text",label:"Rechercher","label-position":$(pe).inside,icon:"search-loupe","is-quiet":"",autocomplete:"off",autofocus:!0,size:e.size||void 0,aria:{ariaDescendant:se.value||"",ariaAutocomplete:"list"},onInput:me,onKeydown:k(I(_,["shift"]),["tab"]),onEscKeydown:ee,onTabKeydown:_,onEnterPressed:ye,onGoUp:a[5]||(a[5]=t=>V($(S).PREVIOUS)),onGoDown:a[6]||(a[6]=t=>V($(S).NEXT))},null,8,["id","modelValue","label-position","size","aria","onKeydown"])])):y("",!0),h.value.length===0?(u(),v("div",Ge," Aucun Résultat ")):(u(),v("div",{key:2,ref:t=>O.value[`${d.value}`]=t,class:T(["lp-dropdown__overflow",{"lp-dropdown__overflow--readonly":e.readonly}]),role:e.searchField?"listbox":void 0,"aria-multiselectable":!!(e.searchField&&e.selectionType===$(f).MULTI)||void 0,"aria-labelledby":e.searchField?`${d.value}-label ${d.value}-search-label`:void 0},[(u(!0),v(X,null,de(h.value,(t,i)=>(u(),v("ul",{key:i,class:"lp-dropdown__group",role:D.value?"group":void 0,"aria-labelledby":D.value?`${d.value}-group-${i}`:void 0},[D.value?(u(),v("li",{key:0,id:`${d.value}-group-${i}`,class:T(["lp-dropdown__group-name",{"lp-dropdown__group-name--border":i!==0}]),role:"presentation"},E(t.groupName),11,Je)):y("",!0),(u(!0),v(X,null,de(t.optionsList,(s,B)=>{var N;return u(),v("li",{key:`${i}-${B}`,id:`${d.value}-option-${s.disabled?i+"-"+B:s.index}`,ref_for:!0,ref:re=>O.value[`${d.value}-option-${s.index}`]=re,class:T(["lp-dropdown__option",[{"lp-dropdown__option--selected":A(s.value)},{"lp-dropdown__option--disabled":s.disabled},{"lp-dropdown__option--focused":Te(s.index)}]]),role:"option","aria-selected":A(s.value),"aria-disabled":s.disabled?s.disabled:void 0,onClick:re=>W(s)},[s.color?(u(),v("span",{key:0,class:"lp-dropdown__color",style:ie({background:s.color})},null,4)):y("",!0),s.icon?(u(),P(Q,{key:1,name:s.icon,class:"lp-dropdown__icon"},null,8,["name"])):y("",!0),typeof s.image=="object"&&s.image!==null?(u(),P(Ne,Ae({key:2,class:"lp-dropdown__image",ref_for:!0},s.image),null,16)):y("",!0),e.loadFlags&&s.flag?(u(),P(ue,{key:3,class:"lp-dropdown__flag",country:{name:(N=s.flag)==null?void 0:N.name,alt:s.flag.alt},lazyload:""},null,8,["country"])):y("",!0),s.checkbox?(u(),v("span",{key:4,class:T([{checked:A(s.value)},"lp-dropdown__checkbox lp-dropdown__checkbox--default checkbox__custom"])},null,2)):y("",!0),te(" "+E(s.label)+" ",1),A(s.value)?(u(),P(Q,{key:5,name:"action-check-switch",class:"lp-dropdown__option--checked",title:"option sélectionnée"})):y("",!0)],10,Qe)}),128))],8,Xe))),128))],10,We))],12,He),[[Ve,c.value]])],2),J(Pe,{id:d.value,message:e.message,"data-error":e.dataError},null,8,["id","message","data-error"])],512)}}}),ia=Oe(ce,[["__scopeId","data-v-bde40add"]]);ce.__docgenInfo={exportName:"default",displayName:"Dropdown",description:"",tags:{},props:[{name:"dataError",required:!0,type:{name:"ErrorMessage"}},{name:"disabled",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"icon",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'arrow-bottom'"}},{name:"label",required:!1,type:{name:"string"}},{name:"labelPosition",required:!1,type:{name:"LabelPosition"},defaultValue:{func:!1,value:"LabelPosition.inside"}},{name:"lazyload",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"listboxHeight",required:!1,type:{name:"number"},defaultValue:{func:!1,value:"300"}},{name:"loadFlags",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"mandatory",required:!1,type:{name:"boolean"}},{name:"message",required:!1,type:{name:"string"}},{name:"name",required:!0,type:{name:"string"}},{name:"options",required:!0,type:{name:"Options"}},{name:"placeholder",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"'Sélectionnez une option'"}},{name:"readonly",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"searchField",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"searchFieldMode",required:!1,type:{name:"DropdownSearchMode"},defaultValue:{func:!1,value:"DropdownSearchMode.CONTAINS"}},{name:"selectionType",required:!1,type:{name:"DropdownSelectionType"},defaultValue:{func:!1,value:"DropdownSelectionType.SIMPLE"}},{name:"size",required:!1,type:{name:"union",elements:[{name:"DropdownSizes"},{name:"undefined"}]},defaultValue:{func:!1,value:"DropdownSizes.MEDIUM"}},{name:"madatory",defaultValue:{func:!1,value:"false"}}],sourceFiles:["/Users/jchourdeaux/workspace/projects/solaris/vue3/src/components/atoms/Dropdown/New/Dropdown.vue"]};export{x as D,ia as S,f as a,ve as b};
